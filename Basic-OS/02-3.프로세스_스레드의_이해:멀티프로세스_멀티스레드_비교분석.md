# 프로세스와 스레드의 이해, 멀티프로세스와 멀티스레드 비교 분석 (keyword: 스레드, 멀티프로세스, 멀티스레드)

## 들어가기 앞서..
- 스레드란, 프로세스를 구성하는 실행의 흐름 단위이다.
- 하나의 프로세스는 하나의 스레드를 가질 수 있다.
- 스레드를 활용하면 하나의 프로세스에서 여러 부분을 동시에 실행 할 수 있다.

### 프로세스와 스레드
- 전통적인 관점에서 보면 하나의 프로세스는 한 번에 하나의 일만을 처리했다.
- 가령 (웹 브라우저, 게임, 워드 프로세서) 프로세스가 있을 때 이 모든 프로세스가 하나의 실행 흐름을 갖고 한번에 하나의 부분만 실행되는 프로세스를 가정했다. (아래그림)

![image](https://github.com/iOS-Woong/OS/assets/96489602/347abb6a-7803-4bb3-871e-f71059ca5bb7)

- 하지만, 스레드라는 개념이 도입되며 하나의 프로세스가 한 번에 여러 일을 동시에 처리할 수 있게 되었다.
- 즉, 프로세스를 구성하는 여러 명령어를 동시에 실행할 수 있게 된 것이다!

![image](https://github.com/iOS-Woong/OS/assets/96489602/8f6bed9b-594a-40bf-a578-6e6056de007c)

- 중요한 것은 프로세스의 스레드들은 실행에 필요한 최소한의 정보 (프로그램 카운터를 포함한 레지스터, 스택) 만을 유지한 채 프로세스 자원을 공유하며 실행된다는 점
- 프로세스 자원을 공유한다는 것이 스레드의 핵심
- 뭔소리? 아래 그림을 보면 스레드 1만의 코드/데이터/힙 영역이 있고, 스레드 2만의 코드/데이터/힙 영역이 있는게 아니라는 뜻임. (스레드들은 서로 프로세스의 자원을 공유하여 실행함)

![image](https://github.com/iOS-Woong/OS/assets/96489602/37a4d3ce-614f-4007-9b4a-d28429561b0e)

### 멀티프로세스와 멀티스레드
- `멀티프로세스` - 컴퓨터는 실행과정에서 여러 프로세스가 동시에 실행될 수 있다는 것을 말함.
- `멀티스레드` - 여러 스레드로 프로세스를 동시에 실행하는 것을 멀티스레드 라고 함.
 
![image](https://github.com/iOS-Woong/OS/assets/96489602/a364b2de-0880-473b-9e25-563da44feb24)

차이점: 동일한 작업을 수행하는 단일 스레드 프로세스 3개 실행 vs 하나의 프로세스를 3개의 스레드로 실행하는 것 의 차이는?
- "hello, os"라는 간단한 프로그램이 있다고 해 보자.
- fork를 3번하여 프로세스를 3개만들어서 실행하는 예제, 스레드를 3개 만들어서 실행하는 예제
- 둘은 모두 hello,os가 세번 출력된다.
- 그러면....
- 이 둘의 차이는 뭘까? 여러 프로세스를 통해서 실행하면 코드영역/데이터영역/힙영역 등을 비롯한 모든 자원이 복제되어 메모리에 적재되게 된다. 따라서 낭비로 이어지게 됨.
- 다른 차이는? 프로세스 간에선 기본적으로 자원을 공유하지 않는다는 점 / 스레드끼린느 같은 프로세스 내의 자원을 공유한다는 점
- 따라서, 스레드끼리는 같은 프로세스 내의 자원을 공유하므로 후자가 훨씬 더 효율적이라는 결론을 도출 할 수 있다.
- 예외case COW(Copy on wirte)를 통해 fork()로 프로세스를 복제하더라도 메모리에 중복 저장하지 않으면서 동시에 프로세스끼리 자원을 공유하지 않는 방법도 있다. 이는 뒷장에서 알아보겠다.

- `프로세스 간 통신 IPC(Inter-Process Communication)` - 프로세스끼리는 기본적으로 자원을 공유하지 않지만, 프로세스끼리도 충분히 자원을 공유하고 데이터를 주고 받을 수 있습니다. 프로세스 간의 자원을 공유하고 데이터를 주고받는 것을 프로세스 간 통신이라고 부른다.
  - 가령, 프로세스A는 hello.text 파일 속 새로운 값을 쓰는 프로세스, 프로세스B는 hello.txt는 파일을 읽는 프로세스라면 두 프로세스는 hello.txt 파일 속 데이터를 주고받으므로 프로세스 간의 통신이 이뤄져야한다. 이는 파일을 통한 프로세스 간 통신으로 볼 수 있다.
  - 이 외에도 소켓, 파이프를 통해 통신할 수 있다. 즉, 프로세스들끼리 데이터를 교환하는 것은 모든 자원을 처음부터 공유하고 있는 스레드에 비하면 다소 까다로운 것일뿐 불가능 한것은 아님.


**중요점 요약**
1. 스레드는 프로세스 내의 실행 흐름 단위이다.
2. 프로세스끼리는 기본적으로 자원을 공유하지 않는다. 하지만, 프로세스 내의 스레드끼리는 같은 프로세스 내 자원을 공유한다.

  
